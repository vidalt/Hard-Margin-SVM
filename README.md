
# Support Vector Machines with the Hard-Margin Loss: Optimal Training via Combinatorial Benders' Cuts

This is the repository for [Support Vector Machines with the Hard-Margin Loss: Optimal Training via Combinatorial Benders' Cuts]().

## Requirements

The source-code is working on MacOS 11.6 using ***Clang++ 11.x.x*** and  Ubuntu 20.x using ***C++ 9.x.x***.
In both versions, ***CPLEX_Studio1210*** is used in the experiments and defined in the makefile. Preliminary tests on ***CPLEX_Studio20*** worked fine as well.

To compile on Ubuntu, you just need to enter **Program/** folder and run:
`make`

For running on MacOSX, you must include myOS parameter as argument in the makefile, so it can compile the code using the right CPLEX root folder. Check it below:
`make myOS=MacOSX` 

#### Corner case
* In case you have a different version than CPLEX_Studio1210, you may execute
`make CPLEXVERSION=CPLEX_Studio@@@` where @@@ refers to the complement of CPLEX_Studio in the folder name. It is also valid f

## Running the algorithm

```
Usage example:
./svm-nonconvex datasetPath -instanceFormat {} -timeProportionCBCuts ${} -timeProportionSampling {} -maxCBCuts {} -problem {} -pen {} -timeBudget {} -seed {}

Available options:
-instanceFormat				Input format to read instances (only 2);
-timeProportionCBCuts  		Proportion of time used to generate CB cuts (Step #1);
-timeProportionSampling 	Proportion of time related to timeProportionCBCuts to generate CB cuts in the sampling phase;
-maxCBCuts 					Maximum number of CB cuts to generate. (-1 for limitless);
-problem 					Set the problem type for solving. (default HARD_IP SVM with hard-margin loss). Available options {FIRST_CB_THEN_HARD_IP SVM with hard-margin loss only CB cuts from the whole model,SAMPLING_CB_HARD_IP = SVM with hard-margin loss with CB from whole model and sampling, HARD_IP = SVM with hard-margin loss, SOFT_HL = SVM with hinge loss,HARD = classic SVM (only feasible if data is linearly separable)};
-pen 						Penalty factor in the objective function, i.e., C value (default 1.0).
-timeBudget 				Maximum of running time (-1 for limitless)
-seed 						Input seed for the pseudorandom number generator (default 1) used in sampling.
-nbThreads					Number of threads for CPLEX (default 1).
-samplingSize				Size of each sampling iteration. (default is min(50,floor(n/2)))
-nbSamplingIterations		Number of iterations for sampling phase. (default is n)
-locallyValidImpliedBounds  Value for locally Valid Implied Bounds parameter in CPLEX (default 3)
-normalizeData 				If 1, the data values are normalized using (value - avg)/std. ''. If 2, these values are normalized using max-min.
```

All instances used in this work were generated by Brooks [1]. 

## Executing

#### Simple example:
`./svm-nonconvex ../Datasets/Brooks_SVM_Data/n500d10ATj0 -instanceFormat 2 -timeProportionCBCuts 0.2 -timeProportionSampling 0.5 -maxCBCuts -1 -problem SAMPLING_CB_HARD_IP -pen 10 -timeBudget 100 -seed 1`

This example reserves 20% of computational time for generating CB cuts, having 50% of 20% used in Sampling phase. Other parameters: C=10, timelimit of 100 seconds and no limit for generating CB cuts.

#### Basic script:

Check `basic.sh` within ***Experiments/*** folder for a working example on all instances using SAMPLING_CB_HARD_IP and HARD_IP with 600 seconds (=10 minutes) of time limit.


#### Reproducing all experiments of the paper:

Run `paper.sh` within ***Experiments/*** folder for the script to reproduce all experiments of the paper.



## References

[1]  J.P. Brooks, Support vector machines with the ramp loss and the hard margin loss, Oper. Res. 59 (2011) 467–479. https://doi.org/10.1287/opre.1100.0854.

## License 

[![License](http://img.shields.io/:license-mit-blue.svg?style=flat-square)](http://badges.mit-license.org)

  

-  **[MIT license](http://opensource.org/licenses/mit-license.php)**

- Copyright(c) 2022 Ítalo Santana